models = {
    "dpn_92": {
        "load_name": "DPN92",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DPN92_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "densenet169": {
        "load_name": "DenseNet169",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DenseNet169_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "densenet264": {
        "load_name": "DenseNet264",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DenseNet264_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b1": {
        "load_name": "EfficientNetB1",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB1_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b3": {
        "load_name": "EfficientNetB3",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB3_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b5": {
        "load_name": "EfficientNetB5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b7": {
        "load_name": "EfficientNetB7",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB7_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "squeezenet1_0": {
        "load_name": "SqueezeNet1_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SqueezeNet1_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "dpn_68": {
        "load_name": "DPN68",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DPN68_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "dpn_131": {
        "load_name": "DPN131",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DPN131_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b2": {
        "load_name": "EfficientNetB2",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB2_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b4": {
        "load_name": "EfficientNetB4",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB4_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b6": {
        "load_name": "EfficientNetB6",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB6_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "densenet201": {
        "load_name": "DenseNet201",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DenseNet201_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "squeezenet1_1": {
        "load_name": "SqueezeNet1_1",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SqueezeNet1_1_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext152_64x4d_vd": {
        "load_name": "ResNeXt152_vd_64x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt152_64x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "se_net154_vd": {
        "load_name": "SENet154_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SENet154_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext101_64x4d_vd": {
        "load_name": "ResNeXt101_vd_64x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt101_64x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext50_64x4d_vd": {
        "load_name": "ResNeXt50_vd_64x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt50_64x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "se_resnext50_32x4d_vd": {
        "load_name": "SE_ResNeXt50_vd_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SE_ResNeXt50_vd_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "res2net50_14w_8s": {
        "load_name": "Res2Net50_14w_8s",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Res2Net50_14w_8s_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext50_64x4d": {
        "load_name": "ResNeXt50_64x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt50_64x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext101_64x4d": {
        "load_name": "ResNeXt101_64x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt101_64x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext152_64x4d": {
        "load_name": "ResNeXt152_64x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt152_64x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "se_resnet50_vd": {
        "load_name": "SE_ResNet50_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SE_ResNet50_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnest50": {
        "load_name": "ResNeSt50",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeSt50_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "dpn_107": {
        "load_name": "DPN107",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DPN107_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "densenet121": {
        "load_name": "DenseNet121",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DenseNet121_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "shufflenet_v2_0_33": {
        "load_name": "ShuffleNetV2_x0_33",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ShuffleNetV2_x0_33_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "ghostnet_1_30": {
        "load_name": "GhostNet_x1_3",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/GhostNet_x1_3_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "xception71": {
        "load_name": "Xception71",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Xception71_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "shufflenet_v2_1_50": {
        "load_name": "ShuffleNetV2_x1_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ShuffleNetV2_x1_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v2_1_50": {
        "load_name": "MobileNetV2_x1_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV2_x1_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v2_0_50": {
        "load_name": "MobileNetV2_x0_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV2_x0_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "shufflenet_v2_1_00_swish": {
        "load_name": "ShuffleNetV2_swish",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ShuffleNetV2_swish_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v2_0_75": {
        "load_name": "MobileNetV2_x0_75",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV2_x0_75_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "shufflenet_v2_2_00": {
        "load_name": "ShuffleNetV2_x2_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ShuffleNetV2_x2_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "inception_v3": {
        "load_name": "InceptionV3",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/InceptionV3_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hardnet68": {
        "load_name": "HarDNet68",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HarDNet68_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rexnet2_0": {
        "load_name": "ReXNet_2_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ReXNet_2_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "xception41": {
        "load_name": "Xception41",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Xception41_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "ghostnet_1_00": {
        "load_name": "GhostNet_x1_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/GhostNet_x1_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rexnet1_0": {
        "load_name": "ReXNet_1_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ReXNet_1_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rexnet1_3": {
        "load_name": "ReXNet_1_3",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ReXNet_1_3_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "regnetx_4GF": {
        "load_name": "RegNetX_4GF",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/RegNetX_4GF_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet18_vd": {
        "load_name": "ResNet18_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet18_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet34_vd": {
        "load_name": "ResNet34_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet34_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet152_vd": {
        "load_name": "ResNet152_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet152_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rednet50": {
        "load_name": "RedNet50",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/RedNet50_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet18_v1": {
        "load_name": "ResNet18",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet18_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet34_v1": {
        "load_name": "ResNet34",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet34_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet50_v1": {
        "load_name": "ResNet50",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet50_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet101_v1": {
        "load_name": "ResNet101",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet101_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet152_v1": {
        "load_name": "ResNet152",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet152_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet50_vd": {
        "load_name": "ResNet50_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet50_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet101_vd": {
        "load_name": "ResNet101_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet101_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnet200_vd": {
        "load_name": "ResNet200_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNet200_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "se_resnet18_vd": {
        "load_name": "SE_ResNet18_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SE_ResNet18_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "se_resnet34_vd": {
        "load_name": "SE_ResNet34_vd",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SE_ResNet34_vd_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rednet26": {
        "load_name": "RedNet26",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/RedNet26_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rednet38": {
        "load_name": "RedNet38",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/RedNet38_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rednet101": {
        "load_name": "RedNet101",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/RedNet101_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rednet152": {
        "load_name": "RedNet152",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/RedNet152_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v1_0_25": {
        "load_name": "MobileNetV1_x0_25",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV1_x0_25_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v1_0_50": {
        "load_name": "MobileNetV1_x0_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV1_x0_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v1_0_75": {
        "load_name": "MobileNetV1_x0_75",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV1_x0_75_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v1_1_00": {
        "load_name": "MobileNetV1",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV1_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v2_0_25": {
        "load_name": "MobileNetV2_x0_25",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV2_x0_25_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v2_1_00": {
        "load_name": "MobileNetV2",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV2_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v2_2_00": {
        "load_name": "MobileNetV2_x2_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV2_x2_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_0_35_large": {
        "load_name": "MobileNetV3_large_x0_35",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_large_x0_35_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_0_50_large": {
        "load_name": "MobileNetV3_large_x0_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_large_x0_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_0_75_large": {
        "load_name": "MobileNetV3_large_x0_75",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_large_x0_75_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_1_00_large": {
        "load_name": "MobileNetV3_large_x1_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_large_x1_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_1_25_large": {
        "load_name": "MobileNetV3_large_x1_25",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_large_x1_25_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_0_35_small": {
        "load_name": "MobileNetV3_small_x0_35",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_small_x0_35_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_0_50_small": {
        "load_name": "MobileNetV3_small_x0_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_small_x0_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_0_75_small": {
        "load_name": "MobileNetV3_small_x0_75",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_small_x0_75_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_1_00_small": {
        "load_name": "MobileNetV3_small_x1_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_small_x1_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mobilenet_v3_1_25_small": {
        "load_name": "MobileNetV3_small_x1_25",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MobileNetV3_small_x1_25_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "shufflenet_v2_0_25": {
        "load_name": "ShuffleNetV2_x0_25",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ShuffleNetV2_x0_25_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "shufflenet_v2_0_50": {
        "load_name": "ShuffleNetV2_x0_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ShuffleNetV2_x0_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "ghostnet_0_50": {
        "load_name": "GhostNet_x0_5",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/GhostNet_x0_5_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext50_32x4d": {
        "load_name": "ResNeXt50_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt50_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext101_32x4d": {
        "load_name": "ResNeXt101_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt101_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext152_32x4d": {
        "load_name": "ResNeXt152_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt152_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext50_32x4d_vd": {
        "load_name": "ResNeXt50_vd_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt50_vd_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext101_32x4d_vd": {
        "load_name": "ResNeXt101_vd_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt101_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext152_32x4d_vd": {
        "load_name": "ResNeXt152_vd_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt152_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnext101_32x8d_wsl": {
        "load_name": "ResNeXt101_32x8d_wsl",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeXt101_32x8d_wsl_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "rexnet3_0": {
        "load_name": "ReXNet_3_0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ReXNet_3_0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "se_resnext50_32x4d": {
        "load_name": "SE_ResNeXt50_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SE_ResNeXt50_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "se_resnext101_32x4d": {
        "load_name": "SE_ResNeXt101_32x4d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/SE_ResNeXt101_32x4d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "res2net50_26w_4s": {
        "load_name": "Res2Net50_26w_4s",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Res2Net50_26w_4s_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "res2net50_26w_4s_vd": {
        "load_name": "Res2Net50_vd_26w_4s",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Res2Net50_vd_26w_4s_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "res2net101_26w_4s_vd": {
        "load_name": "Res2Net101_vd_26w_4s",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Res2Net101_vd_26w_4s_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "res2net200_26w_4s": {
        "load_name": "Res2Net200_vd_26w_4s",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Res2Net200_vd_26w_4s_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "resnest50_fast_1s1x64d": {
        "load_name": "ResNeSt50_fast_1s1x64d",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/ResNeSt50_fast_1s1x64d_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "googlenet": {
        "load_name": "GoogLeNet",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/GoogLeNet_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "xception41_deeplab": {
        "load_name": "Xception41_deeplab",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Xception41_deeplab_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "xception65": {
        "load_name": "Xception65",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Xception65_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "xception65_deeplab": {
        "load_name": "Xception65_deeplab",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/Xception65_deeplab_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "inception_v4": {
        "load_name": "InceptionV4",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/InceptionV4_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mixnet_s": {
        "load_name": "MixNet_S",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MixNet_S_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mixnet_m": {
        "load_name": "MixNet_M",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MixNet_M_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "mixnet_l": {
        "load_name": "MixNet_L",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/MixNet_L_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hrnet_w18_c": {
        "load_name": "HRNet_W18_C",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HRNet_W18_C_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hrnet_w30_c": {
        "load_name": "HRNet_W30_C",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HRNet_W30_C_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hrnet_w32_c": {
        "load_name": "HRNet_W32_C",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HRNet_W32_C_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hrnet_w40_c": {
        "load_name": "HRNet_W40_C",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HRNet_W40_C_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hrnet_w44_c": {
        "load_name": "HRNet_W44_C",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HRNet_W44_C_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hrnet_w48_c": {
        "load_name": "HRNet_W48_C",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HRNet_W48_C_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hrnet_w64_c": {
        "load_name": "HRNet_W64_C",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HRNet_W64_C_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hardnet39_ds": {
        "load_name": "HarDNet39_ds",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HarDNet39_ds_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hardnet68_ds": {
        "load_name": "HarDNet68_ds",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HarDNet68_ds_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "hardnet85": {
        "load_name": "HarDNet85",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/HarDNet85_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "dpn_98": {
        "load_name": "DPN98",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DPN98_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "densenet161": {
        "load_name": "DenseNet161",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/DenseNet161_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b0": {
        "load_name": "EfficientNetB0",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB0_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "efficientnet_b0_small": {
        "load_name": "EfficientNetB0_small",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/EfficientNetB0_small_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "alexnet": {
        "load_name": "AlexNet",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/AlexNet_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "vgg11": {
        "load_name": "VGG11",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/VGG11_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "vgg13": {
        "load_name": "VGG13",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/VGG13_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "vgg16": {
        "load_name": "VGG16",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/VGG16_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    },
    "vgg19": {
        "load_name": "VGG19",
        "model": "https://paddle-imagenet-models-name.bj.bcebos.com/dygraph/inference/VGG19_infer.tar",
        "default_input_shape": (3, 224, 224),
        "default_output_shape": (1000, )
    }
}

import os

from tvm import relay
from conductor._base import get_conductor_path
from conductor.utils import download

import tarfile
from functools import partial


# Download specific to paddle servers for optimal download

DEFAULT_INPUT_NAMES = ["inputs"]

def check_model_file(url, model_name):
    storage_directory = partial(os.path.join, model_name)
    tar_file_name_list = ["inference.pdiparams", "inference.pdiparams.info", "inference.pdmodel"]
    model_file_path = storage_directory("inference.pdmodel")
    params_file_path = storage_directory("inference.pdiparams")
    if not os.path.exists(model_file_path) or not os.path.exists(params_file_path):
        tmp_path = storage_directory(url.split("/")[-1])
        print(f"download {url} to {tmp_path}")
        os.makedirs(storage_directory(), exist_ok=True)
        download(url, tmp_path)
        with tarfile.open(tmp_path, "r") as tarObj:
            for member in tarObj.getmembers():
                filename = None
                for tar_file_name in tar_file_name_list:
                    if tar_file_name in member.name:
                        filename = tar_file_name
                if filename is None:
                    continue
                file = tarObj.extractfile(member)
                with open(storage_directory(filename), "wb") as f:
                    f.write(file.read())
        os.remove(tmp_path)
    if not os.path.exists(model_file_path) or not os.path.exists(params_file_path):
        raise Exception(f"Something went wrong while praparing the model[{model_name}] files!")
    return storage_directory()


def acquire(model_name, details, custom_path=None, force_reload=False):
    """
    Acquires model preexisting details such as pre-trained weights or configuration
    Specific to the framework

    Parameters
    ----------
    model_name : str
        name of the model
    details : dict
        details of the model as registered in the framework definition module
    custom_path : str, optional
        whether to use a custom path for storage
    force_reload : bool, optional
        whether to forcefully reload (usually re-download) any preexisting model details

    Returns
    -------
    any
        framework specific acquisition result
    """

    models_pth = custom_path if custom_path is not None else os.path.join(get_conductor_path(), "models")
    model_pth = os.path.join(models_pth, model_name + "_" + "paddle" + ".cond.framework")
    os.makedirs(model_pth, exist_ok=True)
    return check_model_file(details["model"], model_pth)

def instantiate(model_name, details, acq_result, batch_size=1, in_shape=None, out_shape=None, dtype="float32"):
    import paddle
    """
    Instantiates model given parameters and any acquisition result
    The resultant instance is framework-specific

    Parameters
    ----------
    model_name : str
        name of the model
    details : dict
        details of the model as registered in the framework definition module
    acq_result : any
        framework-specific acquisition result as obtained from acquire()
    batch_size : int, optional
        batch size for the model
    in_shape: tuple, optional
        input shape of the model (tuple of ints)
    out_shape: tuple, optional
        output shape of the model (tuple of ints) i.e. (1000,)
    dtype : str, optional
        data type to be used for the model
    """

    paddle.enable_static()
    paddle.disable_signal_handler()
    exe = paddle.static.Executor(paddle.CPUPlace())
    prog, _, _ = paddle.static.load_inference_model(
        acq_result,
        exe, 
        model_filename="inference.pdmodel", 
        params_filename="inference.pdiparams"
    )
    return prog

def convert(model_instance, batch_size, input_shape, output_shape, dtype="float32"):
    """
    Converts framework-specific model instance object into TVM IR Module

    Parameters
    ----------
    model_instance : any
        framework-specific model instance
    batch_size : int
        batch size for the model
    input_shape: tuple
        input shape of the model (tuple of ints)
    output_shape: tuple
        output shape of the model (tuple of ints) i.e. (1000,)
    dtype : str, optional
        data type to be used for the model
    """
    
    mod, params =  relay.frontend.from_paddle(model_instance, shape_dict={DEFAULT_INPUT_NAMES[0]: (batch_size, ) + input_shape})
    return ((mod, params), {
        "input_name": DEFAULT_INPUT_NAMES[0],
        "batch_size": batch_size,
        "input_shape": input_shape,
        "output_shape": output_shape
    })
